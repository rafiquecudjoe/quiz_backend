version: '3.8'

services:
  nestjs-app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: pdf-processor-nestjs
    restart: unless-stopped
    ports:
      - '3000:3000'
    environment:
      - DATABASE_URL=${DATABASE_URL}
      - RESEND_API_KEY=${RESEND_API_KEY}
      - RESEND_FROM_EMAIL=${RESEND_FROM_EMAIL}
      - GEMINI_API_KEY=${GEMINI_API_KEY}
      - MINIO_ENDPOINT=${MINIO_ENDPOINT}
      - MINIO_PORT=${MINIO_PORT}
      - MINIO_USE_SSL=${MINIO_USE_SSL}
      - MINIO_ACCESS_KEY=${MINIO_ACCESS_KEY}
      - MINIO_SECRET_KEY=${MINIO_SECRET_KEY}
      - MINIO_BUCKET_NAME=${MINIO_BUCKET_NAME}
      - MINIO_PUBLIC_URL=${MINIO_PUBLIC_URL}
      - PYTHON_EXECUTABLE=/app/venv/bin/python
      - PYTHON_VENV_PATH=/app/venv/bin/python
      - PYTHON_SCRIPT_PATH=/app/pdf-processor/test_enriched_batch_processor.py
    volumes:
      - ./uploads:/app/uploads
      - ./output:/app/output
    networks:
      - pdf-processor-network

networks:
  pdf-processor-network:
    driver: bridge

